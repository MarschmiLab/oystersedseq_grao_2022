---
title: "official updated data with new sample names"
author: "Gabriela R Acevedo Oquendo"
date: '2022-06-30'
output: html_document
---
#Load libraries
```{r}
library("tidyr")
library("dplyr")
library("ggplot2")
library("extrafont")
#font_import()
loadfonts(device = "all")
```

## Read data
```{r}
sediment_data <- read.csv("updated_oip copy.csv", stringsAsFactors = TRUE)
#seasons according to the northern hemisphere:
  #spring: March 1 - May 31
  #summer: June 1 - August 31
  #fall: September 1 - November 30
  #winter: December 1 - February 28/29 
  #https://www.timeanddate.com/calendar/aboutseasons.html
```

# Normalized Data column
```{r}

## add to an object so that data frame updates
#change grams to 
  #micrograms = 1000000
  #nanograms = 1000000000
  #microliters = 
#sediment_data %>%
 # select(DNA.Concentration.ng.uL, Elution.uL, Soil.mass.ext_grams) %>%
 # mutate(
    #DNA <- sediment_data$DNA.Concentration.ng.uL,
    #mass <- (sediment_data$Soil.mass.ext_grams * 1000000),
    #elution <- sediment_data$Elution.uL,
  #  NormalizedData <- (sediment_data$DNA.Concentration.ng.uL) * (sediment_data$Elution.uL) * (1/(sediment_data$Soil.mass.ext_grams))
#  )
  
sediment_data_new <- mutate(
  sediment_data, Normalized.Values = sediment_data$DNA.Concentration.ng.uL * sediment_data$Elution.uL * (1/sediment_data$Soil.mass.ext_grams)
)       

print(sediment_data_new)

#normalizeData
```

### plot data - normalized
```{r}
dnaconc <- ggplot(data = sediment_data_new, mapping = aes(x = Location, y = Normalized.Values)) + geom_point(mapping = aes(color=Treatment, shape = Treatment), position = position_jitterdodge()) + scale_color_manual(values = c("lightskyblue2", "plum3")) + geom_boxplot(alpha = 0.3, mapping = aes(color=Treatment), outlier.shape =  NA)  + labs(
  x = "Location",
  y = "DNA Concentration (ng DNA / g sediment)",
  title = "DNA Concentration in Oyster and Bare Sediment Samples Across Locations",
  color = "Treatment"
) + theme(plot.title=element_text(hjust=0.5), panel.background = element_rect(fill = "ivory2"), text = element_text(family = "Times New Roman", size=12))

dnaconc

#+ scale_y_continuous(breaks = seq(from=0, to= 40, by= 5), labels = seq(from=0, to=40, by=5))
#axis.text.x = element_text(angle = 90, hjust = 1)

#wilcox test
#require(graphics)
#x = sediment_data_new$Normalized.Values
#y = sediment_data_new$Normalized.Values
#wilcox.test(x,y, paired = TRUE, alternative = "g")
#wilcox.test(y, x, alternative = "greater", exact = FALSE, correct = FALSE)
#wilcox.test(rnorm(10), rnorm(10, 2), conf.int = TRUE)

#t-test
#require(graphics)
#x=sediment_data_new$Normalized.Values
#t.test(x, y=NULL, alternative = "g", mu=0, paired = FALSE, var.equal = FALSE, conf.level = 0.95)

#ggsave(filename = "DNAConcentrationNormalized.png", plot = dnaconc, width = 22, height = 14, dpi = 300, units = "cm")
```

### t-test for first plot
```{r}

t.test(data = OBaov, OBaov$Normalized.Data.1, OBaov$Normalized.Data.2, paired = TRUE)

```


#### plot data - merging all oyster and bare sediment data - normalized
```{r}
dnaOB <- ggplot(data = sediment_data_new, mapping = aes(x = Treatment, y = Normalized.Values)) + geom_point(mapping = aes(color=Treatment, shape = Treatment), position = position_jitterdodge()) + scale_color_manual(values = c("lightskyblue2", "plum3")) + geom_boxplot(alpha = 0.3, mapping = aes(color=Treatment), outlier.shape = NA)  + labs(
  x = "Sediment Type",
  y = "DNA Concentration (ng DNA / g sediment)",
  title = "DNA Concentration Comparison Between Bare and Oyster Sediments",
  color = "Treatment"
) + theme(plot.title=element_text(hjust=0.5), panel.background = element_rect(fill = "ivory2"), text = element_text(family = "Times New Roman", size=12))

dnaOB

#+ scale_y_continuous(breaks = seq(from=0, to= 40, by= 5), labels = seq(from=0, to=40, by=5))
#ggsave(filename = "DNAConcOB.Normalized.png", plot = dnaOB, width = 20, height = 15, dpi = 300, units = "cm")
```
# anova for the second plot
```{r}
#library(ggplot2)
#library(ggpubr)
#library(tidyverse)
#library(broom)
#library(AICcmodavg)

#summary(sediment_data_new)
#OBaov <- read.csv("aovOB.csv", stringsAsFactors = TRUE)
#one.way <- aov(Normalized.Data.1 ~ Normalized.Data.2, data = OBaov)
#summary(one.way)
```
### kruskal wallis for the second plot
```{r}
kruskal.test(Treatment ~ Normalized.Values, data = sediment_data_new)

```


###### plotting data
```{r}
OBplace <- ggplot(data = sediment_data, mapping = aes(x = Treatment, y = DNA.Concentration.ng.uL)) + geom_point(mapping = aes(color = Treatment, shape = Location), position = position_jitterdodge()) + scale_color_manual(values = c("lightskyblue2", "plum3")) + geom_boxplot(alpha = 0.3, mapping = aes(color=Treatment), outlier.shape = NA) + scale_y_continuous(breaks = seq(from=0, to= 40, by= 5), labels = seq(from=0, to=40, by=5)) + labs(
  x = "Sediment Type",
  y = "DNA Concentration (ng/uL)",
  title = "Comparison Between Oyster and Bare Sediment DNA Conectration Across Locations",
  color = "Treatment"
) + theme(plot.title=element_text(hjust=0.5), panel.background = element_rect(fill = "ivory2"), text = element_text(family = "Times New Roman", size=10))

OBplace
```

## plotting data without TP - normalized
```{r}
#having problems
biomass <- ggplot(data = sediment_data_new, mapping = aes(x = Location, y = Normalized.Values)) + geom_point(mapping = aes(color=Treatment, shape = Treatment), position = position_jitterdodge()) + scale_color_manual(values = c("lightskyblue2", "plum3")) + geom_boxplot(alpha = 0.3, mapping = aes(color=Treatment)) + labs(
  x = "Location",
  y = "DNA Concentration (ng DNA / g sediment)",
  title = "DNA Concentration in Oyster and Bare Sediment Samples Across Locations (no TP)",
  color = "Treatment"
) + theme(plot.title=element_text(hjust=0.5), panel.background = element_rect(fill = "ivory2"), text = element_text(family = "Times New Roman", size=12))

biomass
#filter(sediment_data_new, Location == c('Duxbury Bay', 'Ninigret Pond', 'RWU', 'Saltbox'))
#filter(sediment_data_new$Location == "Town Pond")
#filter(sediment_data_new, Location == "Town Pond")
#filter(sediment_data_new, Location == "Duxbury Bay")
#filter(sediment_data_new, Location == "Ninigret Pond")
#filter(sediment_data_new, Location == "Saltbox")
#filter(sediment_data_new, Location == "RWU")
```


